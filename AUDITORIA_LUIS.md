# AUDITORIA_LUIS

## Resumen
Evaluacion general del proyecto enfocada en violaciones SOLID y code smells.
Total hallazgos: 10.

| # | Hallazgo | Principio vulnerado | Impacto en la escalabilidad |
|---|---|---|---|
| 1 | `OrderService` concentra validacion, reglas, mapeo DTO, persistencia y publicacion de eventos en una sola clase. Evidencia: `order-service/src/main/java/com/restaurant/orderservice/service/OrderService.java:33`, `order-service/src/main/java/com/restaurant/orderservice/service/OrderService.java:84`, `order-service/src/main/java/com/restaurant/orderservice/service/OrderService.java:271`. | SRP (SOLID) | El servicio se vuelve cuello de botella de cambios; aumenta riesgo de regresion y frena trabajo paralelo por equipos. |
| 2 | Validacion duplicada: se valida en DTO y otra vez en servicio (`@NotNull/@Min/@NotEmpty` + `if` manuales). Evidencia: `order-service/src/main/java/com/restaurant/orderservice/dto/CreateOrderRequest.java:22`, `order-service/src/main/java/com/restaurant/orderservice/service/OrderService.java:88`, `order-service/src/main/java/com/restaurant/orderservice/service/OrderService.java:93`. | SRP (SOLID) / Duplicacion de logica (smell) | Cada cambio de regla requiere tocar varias capas; sube deuda de mantenimiento e inconsistencias funcionales. |
| 3 | N+1 query al mapear items de pedidos: por cada item consulta producto por ID. Evidencia: `order-service/src/main/java/com/restaurant/orderservice/service/OrderService.java:271`, `order-service/src/main/java/com/restaurant/orderservice/service/OrderService.java:273`. | Code Smell: N+1 Query | A mayor volumen de items/pedidos, aumenta latencia y carga de BD de forma no lineal. |
| 4 | Publicacion de evento con excepcion silenciada (`catch Exception` sin fail-fast ni outbox). Evidencia: `order-service/src/main/java/com/restaurant/orderservice/service/OrderEventPublisher.java:47`, `order-service/src/main/java/com/restaurant/orderservice/service/OrderEventPublisher.java:50`. | DIP (SOLID) / Smell: swallowed exception | Puede persistirse el pedido sin notificar al consumidor, degradando confiabilidad al escalar la arquitectura asincrona. |
| 5 | Inconsistencia de esquema entre SQL manual y migraciones Flyway (`product/order_item` vs `products/order_items`; estados distintos). Evidencia: `bd/001_create_tables.sql:1`, `bd/001_create_tables.sql:16`, `bd/002_constraints_indexes.sql:2`, `order-service/src/main/resources/db/migration/V1__create_products_table.sql:1`, `order-service/src/main/resources/db/migration/V3__create_order_items_table.sql:1`. | OCP + SRP (SOLID) / Smell: schema drift | Ambientes quedan desalineados y se elevan fallos de despliegue e integracion multi-entorno. |
| 6 | Contrato de evento duplicado en dos microservicios (`OrderPlacedEvent` copiado). Evidencia: `order-service/src/main/java/com/restaurant/orderservice/event/OrderPlacedEvent.java:19`, `kitchen-worker/src/main/java/com/restaurant/kitchenworker/event/OrderPlacedEvent.java:19`. | OCP (SOLID) / Smell: duplicated contract | Evolucionar el payload exige cambios sincronizados manuales; sube probabilidad de incompatibilidades en releases independientes. |
| 7 | Inyeccion por campo con `@Autowired` en worker. Evidencia: `kitchen-worker/src/main/java/com/restaurant/kitchenworker/service/OrderProcessingService.java:27`, `kitchen-worker/src/main/java/com/restaurant/kitchenworker/service/OrderProcessingService.java:28`. | DIP (SOLID) | Reduce testabilidad y dificulta escalar el wiring de dependencias cuando crecen integraciones. |
| 8 | Entidades JPA con `@Data` y relacion bidireccional (`Order`-`OrderItem`). Evidencia: `order-service/src/main/java/com/restaurant/orderservice/entity/Order.java:25`, `order-service/src/main/java/com/restaurant/orderservice/entity/Order.java:61`, `order-service/src/main/java/com/restaurant/orderservice/entity/OrderItem.java:18`. | Code Smell: entidades con equals/hashCode/toString genericos | Con mayor cardinalidad de relaciones, aumenta riesgo de sobrecosto en memoria/CPU y efectos colaterales en colecciones. |
| 9 | Deriva de contrato Front-Back: frontend envia payload redundante (`newStatus` y `status`) y maneja tipos/campos no alineados (`productId: string`, `note` en create). Evidencia: `src/api/orders.ts:45`, `src/api/contracts.ts:15`, `src/api/contracts.ts:36`, `order-service/src/main/java/com/restaurant/orderservice/dto/UpdateStatusRequest.java:19`. | ISP + DIP (SOLID) / Smell: contract drift | Escalar equipos frontend/backend en paralelo se vuelve friccionado por parches de compatibilidad. |
| 10 | `KitchenBoardPage` mezcla UI, orquestacion API, estados async y transiciones de negocio. Evidencia: `src/pages/kitchen/KitchenBoardPage.tsx:34`, `src/pages/kitchen/KitchenBoardPage.tsx:174`, `src/pages/kitchen/KitchenBoardPage.tsx:175`. | SRP (SOLID) / Smell: componente sobredimensionado | Complica evolucionar filtros/estados/polling o migrar a tiempo real sin introducir regresiones. |
